#!/bin/bash
# ==========================================================
# Wrapper for custom-n8n-fim.py
# Ensures Wazuh calls Python correctly
# ==========================================================

ALERT_FILE="$1"
USER="$2"
HOOK_URL="$3"

PYTHON_SCRIPT="/var/ossec/integrations/custom-n8n-fim.py"
LOG_FILE="/var/ossec/logs/integrations.log"

if [ ! -f "$PYTHON_SCRIPT" ]; then
  echo "[custom-n8n-fim] Python script not found!" >> "$LOG_FILE"
  exit 1
fi

/usr/bin/env python3 "$PYTHON_SCRIPT" "$ALERT_FILE" "$USER" "$HOOK_URL"
exit $?
